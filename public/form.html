<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
    />
    <title>Buku Tamu Kemenag Siak</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="main-wrapper">
      <div class="header-card">
        <img src="image/logo.png" alt="Logo Kemenag" class="logo" />

        <div class="header-title">
          BUKU TAMU KANTOR KEMENTERIAN<br />
          AGAMA KABUPATEN SIAK
        </div>
        <div class="header-subtitle">
          Silahkan isi formulir dibawah ini untuk mendaftar
        </div>
      </div>

      <div class="form-card">
        <form id="guestForm">
          <div class="form-group">
            <label for="nama">Nama lengkap</label>
            <input type="text" id="nama" name="nama" required />
          </div>

          <div class="form-group">
            <label for="alamat">Alamat lengkap</label>
            <input type="text" id="alamat" name="alamat" required />
          </div>

          <div class="form-group">
            <label>Jenis kelamin</label>
            <div class="radio-group">
              <div class="radio-option">
                <input
                  type="radio"
                  id="jk_l"
                  name="jenis_kelamin"
                  value="Laki-laki"
                />
                <label for="jk_l">Laki - laki</label>
              </div>
              <div class="radio-option">
                <input
                  type="radio"
                  id="jk_p"
                  name="jenis_kelamin"
                  value="Perempuan"
                />
                <label for="jk_p">Perempuan</label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="tujuan">Tujuan keperluan</label>
            <select id="tujuan" name="tujuan" required>
              <option value="">-- Pilih Tujuan --</option>
              <option value="Kepala Kantor">Kepala Kantor</option>
              <option value="Subbag Tata Usaha">Subbag Tata Usaha</option>
              <option value="Seksi Pendidikan Islam">Seksi Pendidikan Islam</option>
              <option value="Seksi Bimas Islam">Seksi Bimas Islam</option>
              <option value="Penyelenggara Syariah">Penyelenggara Syariah</option>
              <option value="Penyelenggara Kristen">Penyelenggara Kristen</option>
            </select>
          </div>

          <div class="form-group">
            <label for="uraian">Uraian keperluan</label>
            <textarea id="uraian" name="uraian" rows="3" required></textarea>
          </div>

          <div class="form-group">
            <label for="nohp">No Hp/Wa</label>
            <input type="text" id="nohp" name="nohp" required />
          </div>

          <button type="submit">Kirim</button>
        </form>

        <div id="message"></div>
      </div>
    </div>

    <script>
      // --- BAGIAN 1: CEK DATA (Untuk Fitur "Edit Data") ---
      document.addEventListener("DOMContentLoaded", () => {
        const savedData = sessionStorage.getItem("tempTamu");
        if (savedData) {
          const data = JSON.parse(savedData);

          // Isi ulang form secara otomatis
          document.getElementById("nama").value = data.nama || "";
          document.getElementById("alamat").value = data.alamat || "";
          document.getElementById("nohp").value = data.no_hp || "";
          document.getElementById("tujuan").value = data.tujuan || "";
          document.getElementById("uraian").value = data.uraian || "";

          // Isi ulang radio button
          if (data.jenis_kelamin) {
            const radio = document.querySelector(
              `input[name="jenis_kelamin"][value="${data.jenis_kelamin}"]`,
            );
            if (radio) radio.checked = true;
          }
        }
      });

      // --- BAGIAN 2: SAAT TOMBOL DITEKAN ---
      document
        .getElementById("guestForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          // 1. Ambil data dari input form
          const nama = document.getElementById("nama").value;
          const alamat = document.getElementById("alamat").value;
          const tujuan = document.getElementById("tujuan").value;
          const uraian = document.getElementById("uraian").value;
          const nohp = document.getElementById("nohp").value;

          // Ambil data Radio Button
          const jkElement = document.querySelector(
            'input[name="jenis_kelamin"]:checked',
          );
          const jenisKelamin = jkElement ? jkElement.value : null;

          // Validasi Jenis Kelamin
          if (!jenisKelamin) {
            alert("Mohon pilih jenis kelamin.");
            return;
          }

          // 2. Bungkus data jadi satu objek
          const dataTamu = {
            nama: nama,
            alamat: alamat,
            jenis_kelamin: jenisKelamin,
            tujuan: tujuan,
            uraian: uraian,
            no_hp: nohp,
          };

          // 3. SIMPAN KE STORAGE BROWSER (Sementara)
          sessionStorage.setItem("tempTamu", JSON.stringify(dataTamu));

          // 4. PINDAH KE HALAMAN KONFIRMASI
          window.location.href = "konfirmasi.html";
        });
    </script>
  </body>
</html>